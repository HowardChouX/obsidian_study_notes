# 17.5 B树性能

---

## B树运行时间分析

考虑B树的运行时间，设$L$为单个节点的最大条目容量。根据不变式约束，最大高度应介于$\log_{L+1}N$（最佳情况，所有节点均存满$L$个条目）与$\log_2N$（最坏情况，每个节点仅存1个条目）之间。

总体高度始终保持在$\Theta(\log N)$量级。

![最坏情况B树高度](https://cs61b-2.gitbook.io/~gitbook/image?url=https%3A%2F%2F2316889115-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FCLYj7ccqvV6l4Pt9R0w5%252Fuploads%252F91Ssy8VWI5VfprxVcNfN%252Fimage.png%3Falt%3Dmedia%26token%3D03341862-d55b-47ea-a81a-e336b61db3d9&width=768&dpr=4&quality=100&sign=a6a783f8&sv=2)

![最佳情况B树高度](https://cs61b-2.gitbook.io/~gitbook/image?url=https%3A%2F%2F2316889115-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FCLYj7ccqvV6l4Pt9R0w5%252Fuploads%252FIz1soxD54sJkbIdVc1UM%252Fimage.png%3Falt%3Dmedia%26token%3D679b97ea-fa1d-47ee-9de6-cf576e309223&width=768&dpr=4&quality=100&sign=174637f2&sv=2)

---

### `contains`操作运行时间

最坏情况下，每个节点需检查最多$L$个条目。已知树高为对数级，因此`contains`操作的运行时间上界为$O(L\log N)$。由于$L$是常数，可忽略乘积因子，最终运行时间为$O(\log N)$。

---

### `add`操作运行时间

对`add`操作进行类似分析时，需考虑叶子节点分裂的情形。由于树高为$O(\log N)$，最坏情况下需要执行$\log N$次分裂操作（从叶子节点级联至根节点）。这仅会在运行时间中增加$\log N$的加法因子，整体运行时间仍保持为$O(\log N)$。