### ** 学习建议**
本章介绍方差分析(Analysis of Variance, ANOVA)，用于研究分类自变量对连续因变量的影响是否显著。它是假设检验的重要应用和扩展，核心思想是将总变异分解为不同来源的变异。
- **核心重点（★★★★★）**：8.1, 8.3 节是重中之重。必须掌握单因素方差分析的基本原理和双因素有交互作用的方差分析。
- **理解关键（★★★☆☆）**：8.2 节是双因素分析的简化情况，需要理解其与8.3节的区别。
- **核心思路**：本章遵循"建立数学模型 -> 提出假设 -> 构造检验统计量 -> 方差分析表 -> 统计决策"的基本流程。

---
### 8.1 单因素试验的方差分析 ★★★★★
- **基本问题**：检验单个因素的不同水平对试验结果是否有显著影响。
- **数学模型**：
  - $X_{ij} = \mu_i + \varepsilon_{ij} = \mu + \alpha_i + \varepsilon_{ij}, \quad j=1,2,...,n_i; i=1,2,...,r$
  - 其中 $\mu$ 为总平均，$\alpha_i$ 为第 $i$ 个水平的效应，满足 $\sum_{i=1}^r \alpha_i = 0$
  - $\varepsilon_{ij} \sim N(0, \sigma^2)$ 且相互独立
- **假设检验**：
  - $H_0: \alpha_1 = \alpha_2 = \cdots = \alpha_r = 0$ （各水平效应无显著差异）
  - $H_1: \alpha_1, \alpha_2, ..., \alpha_r$ 不全为0
- **方差分解**：
  - 总离差平方和：$S_T = \sum_{i=1}^r \sum_{j=1}^{n_i} (X_{ij} - \bar{X})^2$
  - 组间离差平方和：$S_A = \sum_{i=1}^r n_i (\bar{X}_{i\cdot} - \bar{X})^2$
  - 组内离差平方和：$S_E = \sum_{i=1}^r \sum_{j=1}^{n_i} (X_{ij} - \bar{X}_{i\cdot})^2$
  - 关系：$S_T = S_A + S_E$
- **检验统计量**：
  - $F = \frac{S_A/(r-1)}{S_E/(n-r)} \sim F(r-1, n-r)$ （在 $H_0$ 成立时）
  - 其中 $n = \sum_{i=1}^r n_i$ 为总样本量
- **拒绝域**：$\{F > F_\alpha(r-1, n-r)\}$

### 8.2 双因素无重复试验的方差分析 ★★★☆☆
- **适用情况**：考察两个因素对试验结果的影响，但每个水平组合只进行一次试验（无重复）。
- **数学模型**：
  - $X_{ij} = \mu + \alpha_i + \beta_j + \varepsilon_{ij}, \quad i=1,...,r; j=1,...,s$
  - 其中 $\alpha_i$ 为因素A第 $i$ 水平的效应，$\beta_j$ 为因素B第 $j$ 水平的效应
  - 约束条件：$\sum_{i=1}^r \alpha_i = 0$, $\sum_{j=1}^s \beta_j = 0$
- **假设检验**：
  - 因素A：$H_{01}: \alpha_1 = \alpha_2 = \cdots = \alpha_r = 0$
  - 因素B：$H_{02}: \beta_1 = \beta_2 = \cdots = \beta_s = 0$
- **方差分解**：
  - $S_T = S_A + S_B + S_E$
  - $S_A = s \sum_{i=1}^r (\bar{X}_{i\cdot} - \bar{X})^2$ （因素A的离差平方和）
  - $S_B = r \sum_{j=1}^s (\bar{X}_{\cdot j} - \bar{X})^2$ （因素B的离差平方和）
  - $S_E = S_T - S_A - S_E$ （误差平方和）
- **检验统计量**：
  - $F_A = \frac{S_A/(r-1)}{S_E/[(r-1)(s-1)]} \sim F(r-1, (r-1)(s-1))$
  - $F_B = \frac{S_B/(s-1)}{S_E/[(r-1)(s-1)]} \sim F(s-1, (r-1)(s-1))$

### 8.3 双因素等重复试验的方差分析 ★★★★★
- **适用情况**：考察两个因素及其交互作用对试验结果的影响，每个水平组合进行 $t$ 次重复试验（$t \geq 2$）。
- **数学模型**：
  - $X_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \varepsilon_{ijk}$
  - 其中 $(\alpha\beta)_{ij}$ 为因素A与B的交互效应
  - 约束条件：$\sum_i \alpha_i = 0$, $\sum_j \beta_j = 0$, $\sum_i (\alpha\beta)_{ij} = 0$, $\sum_j (\alpha\beta)_{ij} = 0$
- **假设检验**：
  - 因素A：$H_{01}: \alpha_1 = \alpha_2 = \cdots = \alpha_r = 0$
  - 因素B：$H_{02}: \beta_1 = \beta_2 = \cdots = \beta_s = 0$  
  - 交互作用：$H_{03}: (\alpha\beta)_{ij} = 0$ 对所有 $i,j$
- **方差分解**：
  - $S_T = S_A + S_B + S_{A\times B} + S_E$
  - $S_{A\times B} = t \sum_{i=1}^r \sum_{j=1}^s (\bar{X}_{ij\cdot} - \bar{X}_{i\cdot\cdot} - \bar{X}_{\cdot j\cdot} + \bar{X})^2$ （交互作用平方和）
- **检验统计量**：
  - $F_A = \frac{S_A/(r-1)}{S_E/[rs(t-1)]} \sim F(r-1, rs(t-1))$
  - $F_B = \frac{S_B/(s-1)}{S_E/[rs(t-1)]} \sim F(s-1, rs(t-1))$
  - $F_{A\times B} = \frac{S_{A\times B}/[(r-1)(s-1)]}{S_E/[rs(t-1)]} \sim F((r-1)(s-1), rs(t-1))$
