#### **本章学习目标**
熟练掌握使用DDL（数据定义语言）对数据库、基本表和索引进行创建、修改和删除操作。

---

### **`★ 5.1 数据库的定义及维护`**

#### **1. 创建数据库**
```sql
CREATE DATABASE [IF NOT EXISTS] database_name;
```
-   **`[IF NOT EXISTS]`**：可选子句。如果数据库已存在，加上此选项可防止报错，只会产生一个警告。
-   **示例**：
    ```sql
    CREATE DATABASE school;          -- 创建名为school的数据库
    CREATE DATABASE IF NOT EXISTS school; -- 安全创建，避免重复创建错误
    ```

#### **2. 选择数据库**
在对表进行操作前，必须明确指定使用哪个数据库。
```sql
USE database_name;
```
-   **示例**：`USE school;` （后续操作如建表，都会在 `school` 数据库中进行）

#### **3. 删除数据库**
**`【警告】此操作极其危险！会删除数据库及其所有数据，不可恢复！`**
```sql
DROP DATABASE [IF EXISTS] database_name;
```
-   **`[IF EXISTS]`**：可选子句。如果数据库不存在，加上此选项可防止报错。
-   **示例**：`DROP DATABASE IF EXISTS old_school;`

#### **4. 查看数据库**
```sql
SHOW DATABASES; -- 显示所有数据库
```

---

### **`★★★ 5.2 基本表的定义及维护`**

这是本章的核心，需要重点掌握。

#### **1. 创建表**
```sql
CREATE TABLE [IF NOT EXISTS] table_name (
    column1 datatype [column_constraint],
    column2 datatype [column_constraint],
    ...,
    [table_constraint]
);
```
-   **`column_constraint`**（列级完整性约束）：跟在列定义后面。
-   **`table_constraint`**（表级完整性约束）：单独作为一行，用于定义主键、外键等涉及多列的约束。

**`关键约束条件详解`**

| 约束 | 关键字 | 说明 | 级别 |
| :--- | :--- | :--- | :--- |
| **`主键约束`** | `PRIMARY KEY` | 唯一标识每行，**非空且唯一**。 | 列级/表级 |
| **`唯一约束`** | `UNIQUE` | 保证该列的值必须唯一，**但可为空**。 | 列级/表级 |
| **`非空约束`** | `NOT NULL` | 保证该列的值不能为NULL。 | 列级 |
| **`默认值`** | `DEFAULT value` | 如果插入数据时未指定该列的值，则使用默认值。 | 列级 |
| **`外键约束`** | `FOREIGN KEY` | 保证参照完整性。 | **表级** |
| **`自动增长`** | `AUTO_INCREMENT` | 整数列自动递增（通常用于主键）。 | 列级 |

**`综合创建表示例`**
根据我们之前E-R图转换的规则，创建学生表、课程表和选课表。
```sql
-- 创建课程表（被参照表，应先创建）
CREATE TABLE IF NOT EXISTS Course (
    Cno CHAR(4) PRIMARY KEY,          -- 课程号，定长字符串，主键（列级约束）
    Cname VARCHAR(40) NOT NULL UNIQUE, -- 课程名，变长字符串，非空且唯一
    Credit SMALLINT UNSIGNED          -- 学分，小整数，无符号
);

-- 创建学生表
CREATE TABLE IF NOT EXISTS Student (
    Sno CHAR(10) PRIMARY KEY,         -- 学号，主键
    Sname VARCHAR(20) NOT NULL,       -- 姓名，非空
    Ssex ENUM('男', '女') DEFAULT '男', -- 性别，枚举类型，默认'男'
    Sage TINYINT UNSIGNED,            -- 年龄，微整数，无符号
    Sdept VARCHAR(20)                 -- 所在系
);

-- 创建选课表（参照表，应后创建）
CREATE TABLE IF NOT EXISTS SC (
    Sno CHAR(10),                     -- 学号
    Cno CHAR(4),                      -- 课程号
    Grade DECIMAL(4,1),               -- 成绩，定点数，一位小数
    PRIMARY KEY (Sno, Cno),           -- 主键由学号和课程号共同构成（表级约束）
    FOREIGN KEY (Sno) REFERENCES Student(Sno),  -- 外键，参照Student表的Sno
    FOREIGN KEY (Cno) REFERENCES Course(Cno)    -- 外键，参照Course表的Cno
);
```

#### **2. 修改表结构**
使用 `ALTER TABLE` 语句，这是非常灵活且常用的操作。

-   **添加列**
    ```sql
    ALTER TABLE table_name ADD column_name datatype [constraint];
    ```
    *示例：给学生表添加一个`Email`列：`ALTER TABLE Student ADD Email VARCHAR(50);`*

-   **修改列的数据类型或约束**
    ```sql
    ALTER TABLE table_name MODIFY column_name new_datatype [constraint];
    ```
    *示例：将学生姓名的长度改为30：`ALTER TABLE Student MODIFY Sname VARCHAR(30) NOT NULL;`*

-   **删除列**
    ```sql
    ALTER TABLE table_name DROP column_name;
    ```
    *示例：删除刚添加的`Email`列：`ALTER TABLE Student DROP Email;`*

-   **添加约束**
    ```sql
    -- 添加主键
    ALTER TABLE table_name ADD PRIMARY KEY (column_name);
    -- 添加外键
    ALTER TABLE table_name ADD FOREIGN KEY (column_name) REFERENCES other_table(pk_column);
    ```

#### **3. 删除表**
**`【警告】此操作会删除表结构和所有数据，请谨慎使用！`**
```sql
DROP TABLE [IF EXISTS] table_name;
```
*示例：`DROP TABLE IF EXISTS TempTable;`*

#### **4. 查看表**
```sql
SHOW TABLES;                    -- 查看当前数据库所有表
DESC table_name;                -- 查看表结构
SHOW CREATE TABLE table_name;   -- 查看建表语句（更详细）
```

---

### **`★★ 5.3 索引的定义及维护`**

#### **1. 索引是什么？**
-   **通俗比喻**：就像一本书的**目录**。没有目录，你要找某个内容需要一页一页翻（全表扫描）；有了目录，你可以快速定位到对应的页码（直接访问数据）。
-   **作用**：**大大加快数据的查询速度**。
-   **代价**：索引需要占用额外的存储空间，并且会降低数据插入、更新和删除的速度（因为索引也需要维护）。

#### **2. 创建索引**
-   **自动创建**：在定义 `PRIMARY KEY` 或 `UNIQUE` 约束时，MySQL会自动为相应的列创建索引。
-   **手动创建**：
    ```sql
    CREATE [UNIQUE] INDEX index_name ON table_name (column_name [ASC|DESC], ...);
    ```
    -   `UNIQUE`：创建唯一索引。
    -   可以基于单列或多列（复合索引）创建。
    -   **示例**：
        ```sql
        -- 在学生表的姓名上创建普通索引，加快按姓名查询的速度
        CREATE INDEX idx_sname ON Student (Sname);
        -- 在选课表上按学号和课程号创建索引（顺序很重要）
        CREATE INDEX idx_sno_cno ON SC (Sno, Cno);
        ```

#### **3. 删除索引**
```sql
DROP INDEX index_name ON table_name;
```
*示例：`DROP INDEX idx_sname ON Student;`*

---

### **本章总结与复习建议**

-   **核心技能**：**熟练编写 `CREATE TABLE` 语句**，并能正确定义主键、外键和各种约束。这是数据库设计的直接体现。
-   **核心操作**：掌握使用 `ALTER TABLE` 来修改表结构，这是数据库维护的常见任务。
-   **核心理解**：理解**索引的作用和代价**，知道在哪些列上建立索引可以优化查询（通常是 `WHERE` 子句和 `JOIN` 条件中频繁使用的列）。

建议你打开MySQL客户端，亲手输入本章的示例代码，观察执行结果，这对巩固记忆非常有帮助。下一章我们将学习如何向这些表中插入和修改数据。