> æƒ³è±¡ä½ å¼€äº†ä¸€å®¶**æ™ºèƒ½è›‹ç³•å·¥å‚**ï¼Œæ„é€ å‡½æ•°å°±åƒè›‹ç³•çš„ã€Œç”Ÿäº§æµæ°´çº¿è¯´æ˜ä¹¦ã€


# **é»˜è®¤æ„é€ å‡½æ•°**Â â†’ åŸºç¡€æ¬¾æµæ°´çº¿


```c++
class Cake 
{
public:
    // é»˜è®¤æ„é€ ï¼šé¢ç²‰+é¸¡è›‹çš„åŸºç¡€æ¬¾
    Cake() 
    { 
        flavor = "åŸå‘³"; 
        layers = 1; 
    }
};
```

> é»˜è®¤æ„é€ å‡½æ•°
---

# **å‚æ•°åŒ–æ„é€ å‡½æ•°**Â â†’ å®šåˆ¶åŒ–æµæ°´çº¿

```c++
class Cake 
{
public:
    // å®šåˆ¶æ„é€ ï¼šå®¢æˆ·è‡ªé€‰å£å‘³å’Œå±‚æ•°
    Cake(string f, int l) 
    { 
        flavor = f; 
        layers = l; 
    }
};
```

---

#  **æ‹·è´æ„é€ å‡½æ•°**Â â†’ å…‹éš†æµæ°´çº¿

```c++
class Cake 
{
public:
    // æ‹·è´æ„é€ ï¼šå®Œç¾å¤åˆ¶å¦ä¸€ä¸ªè›‹ç³•
    Cake(const Cake& other) 
    {
        flavor = other.flavor; 
        layers = other.layers;
    }
};
```

---

# å…³é”®ç‰¹æ€§æ¼”ç¤º
```c++
int main() 
{
    Cake defaultCake;       // ğŸ‚è‡ªåŠ¨ç”Ÿäº§åŸºç¡€æ¬¾ï¼ˆåŸå‘³1å±‚ï¼‰
    Cake customCake("è‰è“", 5); // ğŸ‚æŒ‰è®¢å•ç”Ÿäº§ï¼ˆè‰è“5å±‚ï¼‰
    Cake cloneCake(customCake); // ğŸ‚å…‹éš†è‰è“è›‹ç³•
    
    // é”™è¯¯ç¤ºä¾‹ï¼šæ²¡æœ‰åŒ¹é…çš„æµæ°´çº¿
    // Cake errorCake("èŠ’æœ");  âŒ å·¥å‚æ²¡èŠ’æœé…æ–¹ï¼ˆç¼ºå°‘å¯¹åº”æ„é€ å‡½æ•°ï¼‰
}
```


```c++
//é»˜è®¤æ„é€ å‡½æ•°Entityã€23ã€‘
class Entity
{
public:
    float X,Y;
    Entity
    {
        X = 0.0f
        Y = 0.0f
    }
    Entityï¼ˆint x, int y)
    {
        X = x;
        Y = y;
    }
    void Print()
    {
        std==cout << X << "," << Y <<std==endl;
    }
}
int main()
{
    Entity e(10.0f,5.0f);
    e.Print();
    std::cin.get();
}

```

# å¤åˆ¶æ„é€ å‡½æ•°

## æµ…æ‹·è´

```c++
[[include]] <iostream>   // è¾“å…¥è¾“å‡ºæµåº“
[[include]] <cstring>     // å­—ç¬¦ä¸²åº“
class String
{
private:
	char* m_Buffer;
	unsigned int m_Size;
public:
	String(const char* string)//é»˜è®¤æ„é€ å‡½æ•°
	{
		m_Size = strlen(string);
		m_Buffer = new char[m_Size + 1];
		memcpy(m_Buffer,string, m_Size);
		m_Buffer[m_Size] = 0;
	}
	~String()
	{
		delete[] m_Buffer;
	}

	char& operator[](unsigned int index)
	{
		return m_Buffer[index];
	}
	friend std==ostream& operator<<(std==ostream& stream, const String& string);
};
std==ostream& operator<<(std==ostream& stream, const String& string)
{
	stream << string.m_Buffer;
	return stream;
}
void PrintString(const String& string)
{
	std==cout << string << std==endl;

}
int main()
{
	String string = "Cherno";
	String second = string;//æµ…æ‹·è´,è§¦å‘é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œç›´æ¥å¤åˆ¶æŒ‡é’ˆåœ°å€å’Œæ•°å€¼ï¼Œå½¢æˆå†…å­˜å…±äº«ï¼›
	second[2] = 'a';

	PrintString(string);
	PrintString(second);
	std::cin.get();
}
```

---

## æ·±æ‹·è´
```c++
[[include]] <iostream>
[[include]] <cstring>

class String
{
private:
	unsigned m_Size;
	char* m_Buffer;
	public:
	String(const char* string)
	{
		m_Size = strlen(string);
		m_Buffer = new char[m_Size + 1];
		memcpy(m_Buffer, string, m_Size);
		m_Buffer[m_Size] = 0;
	}
	String(const String& other)
		: m_Size(other.m_Size)
	{
		m_Buffer = new char[m_Size + 1];//ä½¿æ‹·è´å‡½æ•°æœ‰è‡ªå·±çš„æŒ‡é’ˆ
		memcpy(m_Buffer, other.m_Buffer, m_Size + 1);
	}
	~String()
	{
		delete[]m_Buffer;
	}
	char& operator[](unsigned int index)
	{
		return m_Buffer[index];
	}
	friend std==ostream& operator<<(std==ostream& stream, const String& string);
};
std==ostream& operator<<(std==ostream& stream, const String& string)
{
	stream << string.m_Buffer;
	return stream;
}
void PrintString(const String& string)
{
	std==cout << string << std==endl;
}
int main()
{
	String string = "Cherno";
	String second = string;//æ·±æ‹·è´ï¼Œè§¦å‘æ‹·è´æ„é€ å‡½æ•°

	second[2] = 'a';

	std==cout << string << std==endl;
	std==cout << second << std==endl;
}
```



---


## æ·±æ‹·è´ã€44ã€‘
```c++
[[include]] <iostream>   // æ ‡å‡†è¾“å…¥è¾“å‡ºæµ
[[include]] <cstring>     // æä¾›strlen/memcpyç­‰å‡½æ•°

class String
{
private:
    // æ•°æ®æˆå‘˜ ===============================================
    char* m_Buffer;      // å †å†…å­˜æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨å­—ç¬¦ä¸²å†…å®¹
    unsigned int m_Size; // æœ‰æ•ˆå­—ç¬¦é•¿åº¦ï¼ˆä¸å«ç»ˆæ­¢ç¬¦'\0'ï¼‰

public:
    // æ„é€ ä¸ææ„ =============================================
    // å‚æ•°åŒ–æ„é€ å‡½æ•°ï¼šä»Cé£æ ¼å­—ç¬¦ä¸²åˆå§‹åŒ–
    // æ—¶é—´å¤æ‚åº¦ï¼šO(n), nä¸ºè¾“å…¥å­—ç¬¦ä¸²é•¿åº¦
    String(const char* string)
    {
        m_Size = strlen(string);            // è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦
        m_Buffer = new char[m_Size + 1];    // åˆ†é…å†…å­˜ï¼ˆ+1ç”¨äºå­˜æ”¾ç»ˆæ­¢ç¬¦ï¼‰
        memcpy(m_Buffer, string, m_Size);   // å¤åˆ¶å­—ç¬¦å†…å®¹
        m_Buffer[m_Size] = '\0';            // æ˜¾å¼æ·»åŠ å­—ç¬¦ä¸²ç»ˆæ­¢ç¬¦
        
        /* æ›¿ä»£æ–¹æ¡ˆï¼š
        strcpy(m_Buffer, string); // ä¼šè‡ªåŠ¨å¤åˆ¶ç»ˆæ­¢ç¬¦ï¼Œä½†éœ€ç¡®ä¿ç›®æ ‡å†…å­˜è¶³å¤Ÿ */
    }

    // æ‹·è´æ„é€ å‡½æ•°ï¼ˆæ·±æ‹·è´å®ç°ï¼‰
    // ç¡®ä¿ï¼šæ–°å¯¹è±¡æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´
    String(const String& other)
        : m_Size(other.m_Size) // åˆå§‹åŒ–åˆ—è¡¨å¤åˆ¶é•¿åº¦
    {
        std==cout << "Copied String!" << std==endl; // è°ƒè¯•è¾“å‡º
        m_Buffer = new char[m_Size + 1];           // åˆ†é…æ–°å†…å­˜
        memcpy(m_Buffer, other.m_Buffer, m_Size + 1); // å¤åˆ¶å†…å®¹å«ç»ˆæ­¢ç¬¦
    }

    // ææ„å‡½æ•°ï¼šé‡Šæ”¾å †å†…å­˜
    ~String()
    {
        delete[] m_Buffer; // é‡Šæ”¾å­—ç¬¦æ•°ç»„å†…å­˜
        // æ³¨æ„ï¼šnew[] å¿…é¡»å¯¹åº” delete[] é¿å…å†…å­˜æ³„æ¼
    }
    
    // è¿ç®—ç¬¦é‡è½½ =============================================
    // ä¸‹æ ‡è¿ç®—ç¬¦ï¼ˆéconstç‰ˆæœ¬ï¼Œå…è®¸ä¿®æ”¹å­—ç¬¦ï¼‰
    // æ³¨æ„ï¼šæœªå®ç°è¶Šç•Œæ£€æŸ¥ï¼Œå­˜åœ¨å®‰å…¨é£é™©
    char& operator[](unsigned int index)
    {
        return m_Buffer[index]; // è¿”å›å­—ç¬¦å¼•ç”¨ä»¥ä¾¿ä¿®æ”¹
    }

    // å‹å…ƒå‡½æ•°å£°æ˜ ===========================================
    // å…è®¸è¾“å‡ºè¿ç®—ç¬¦è®¿é—®ç§æœ‰æˆå‘˜ï¼ˆä¸ç ´åå°è£…åŸåˆ™çš„ç‰¹æ®Šæˆæƒï¼‰
    friend std==ostream& operator<<(std==ostream& stream, const String& string);
};

// å…¨å±€è¿ç®—ç¬¦é‡è½½å®ç° =========================================
// è¾“å‡ºè¿ç®—ç¬¦ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰
std==ostream& operator<<(std==ostream& stream, const String& string)
{
    stream << string.m_Buffer;  // ç›´æ¥è®¿é—®ç§æœ‰ç¼“å†²åŒº
    return stream;              // è¿”å›æµå¯¹è±¡æ”¯æŒè¿ç»­<<æ“ä½œ
}

// å·¥å…·å‡½æ•° ==================================================
// æ‰“å°å­—ç¬¦ä¸²å¯¹è±¡ï¼ˆæ¼”ç¤ºä¼ å¼•ç”¨é¿å…æ‹·è´ï¼‰
void PrintString(const String& string)
{
    std==cout << string << std==endl; // constå¼•ç”¨ç¡®ä¿å¯¹è±¡ä¸è¢«ä¿®æ”¹
}

int main()
{
    // éšå¼æ„é€ å‡½æ•°è°ƒç”¨ï¼šString(const char*)
    String string = "Cherno";  // ç­‰ä»·äº String string("Cherno");
    
    // æ‹·è´æ„é€ å‡½æ•°è°ƒç”¨ï¼ˆæ·±æ‹·è´ï¼‰
    String second = string;    // æ‰“å°"Copied String!"
    
    // ä¿®æ”¹å‰¯æœ¬å†…å®¹ï¼ˆæ¼”ç¤ºoperator[]ï¼‰
    second[2] = 'a';           // ä¿®æ”¹ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰
    //è§¦å‘æ‹·è´æ„é€ å‡½æ•°
    // è¾“å‡ºç»“æœå¯¹æ¯”
    PrintString(string);  // è¾“å‡ºåŸå¯¹è±¡ï¼šCherno
    PrintString(second);  // è¾“å‡ºä¿®æ”¹åå¯¹è±¡ï¼šCharno

    std::cin.get(); // ä¿æŒæ§åˆ¶å°çª—å£æ‰“å¼€
}
```

# æµ…æ‹·è´ä¸æ·±æ‹·è´çš„åŒºåˆ«

| **ç‰¹æ€§**     | æµ…æ‹·è´ (Shallow Copy)                         | æ·±æ‹·è´ (Deep Copy)                            |
| ---------- | ------------------------------------------ | ------------------------------------------ |
| **å†…å­˜å¤åˆ¶æ–¹å¼** | ä»…å¤åˆ¶æŒ‡é’ˆå€¼ï¼ˆåœ°å€ç›¸åŒï¼‰                               | åˆ›å»ºæ–°å†…å­˜å¹¶å¤åˆ¶æ•°æ®ï¼ˆåœ°å€ä¸åŒï¼‰                           |
| **å†…å­˜ç¤ºæ„å›¾**  | ![æµ…æ‹·è´å†…å­˜å›¾](https://i.imgur.com/3XvW7r2.png) | ![æ·±æ‹·è´å†…å­˜å›¾](https://i.imgur.com/5Rk9ZtG.png) |
| **ä¿®æ”¹å½±å“**   | ä¿®æ”¹å‰¯æœ¬ä¼šå½±å“åŸå¯¹è±¡                                 | å‰¯æœ¬ä¸åŸå¯¹è±¡å®Œå…¨ç‹¬ç«‹                                 |
| **ææ„å®‰å…¨æ€§**  | å¯¼è‡´åŒé‡é‡Šæ”¾ï¼ˆdouble freeï¼‰å´©æºƒ                      | å¯å®‰å…¨ææ„                                      |
| **æ€§èƒ½**     | å¿«ï¼ˆä»…å¤åˆ¶æŒ‡é’ˆï¼‰                                   | è¾ƒæ…¢ï¼ˆéœ€åˆ†é…å†…å­˜+æ•°æ®å¤åˆ¶                              |

```c++
//å…³é”®å·®å¼‚ä»£ç æ¼”ç¤º
class String 
{
    char* m_Buffer;
    int m_Size;
public:
    // æµ…æ‹·è´æ„é€ ï¼ˆå±é™©ï¼ï¼‰
    String(const String& other) 
        : m_Buffer(other.m_Buffer),  // ä»…å¤åˆ¶æŒ‡é’ˆ
          m_Size(other.m_Size) 
    {}

    // æ·±æ‹·è´æ„é€ ï¼ˆå®‰å…¨ï¼‰
    String(const String& other) 
        : m_Size(other.m_Size) 
    {
        m_Buffer = new char[m_Size + 1];  // åˆ†é…æ–°å†…å­˜
        memcpy(m_Buffer, other.m_Buffer, m_Size + 1);  // å¤åˆ¶æ•°æ®
    }
};
```