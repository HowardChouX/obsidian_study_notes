
# æ–‡ä»¶ä½œç”¨åŸŸé—´çš„static


> **æ–‡ä»¶ä½œç”¨åŸŸçš„Â `static`Â å˜é‡**ï¼ˆå³å…¨å±€å˜é‡å‰åŠ Â `static`ï¼‰å°±åƒä¸€ä¸ªã€Œæ–‡ä»¶ä¸“å±žä¿é™©ç®±.

### ç±»æ¯”ï¼ˆå‡è®¾æœ‰ä¸¤ä¸ªæ–‡ä»¶Â `A.cpp`å’ŒÂ `B.cpp`ï¼‰
```c++
// A.cpp
static int secret = 100; // æ–‡ä»¶Açš„ä¸“å±žä¿é™©ç®±ï¼ˆAçš„privateï¼‰ï¼›
```


```c++
// B.cpp
extern int secret; //åœ¨å…¶å®ƒæ–‡ä»¶å¯»æ‰¾secret âŒ ç¼–è¯‘é”™è¯¯ï¼Bæ–‡ä»¶æ‰¾ä¸åˆ°è¿™ä¸ªä¿é™©ç®±
```

æ­¤æ—¶ï¼š

1. `A.cpp`Â ä¸­çš„Â `secret`Â æ˜¯ã€Œå¸¦å¯†ç çš„ä¿é™©ç®±ã€  
    â€”â€” åªæœ‰Â `A.cpp`Â å†…éƒ¨çš„ä»£ç èƒ½è®¿é—®å®ƒ
2. `B.cpp`Â å³ä½¿å¼ºè¡Œç”¨Â `extern`Â å£°æ˜Žï¼Œä¹Ÿ**æ— æ³•è®¿é—®æˆ–ä¿®æ”¹**è¿™ä¸ªå˜é‡

### å¯¹æ¯”ï¼ˆå¦‚æžœåŽ»æŽ‰Â `static`ï¼‰
```c++
// A.cpp
int publicVar = 100; // å…¬å…±ä¿é™©ç®±ï¼ˆå¤–éƒ¨é“¾æŽ¥æ€§ï¼‰
```

```c++
// B.cpp
extern int publicVar; // âœ… å¯ä»¥è®¿é—®ï¼
```
---

### å®žé™…æ„ä¹‰

> è¿™ç§è®¾è®¡å¯ä»¥é¿å…**è·¨æ–‡ä»¶çš„å‘½åå†²çª**ã€‚
> ä¸¤ä¸ªÂ `counter`Â äº’ä¸å¹²æ‰°ï¼Œå°±åƒä¸¤ä¸ªå…¬å¸å„è‡ªæœ‰ç‹¬ç«‹çš„ã€Œè´¢åŠ¡è´¦æœ¬ã€ã€‚

```c++
// File1.cpp
static int counter = 0; // æ–‡ä»¶1çš„è®¡æ•°å™¨
```


```c++

// File2.cpp
static int counter = 0; // æ–‡ä»¶2çš„è®¡æ•°å™¨
```

---

### æ›¿ä»£æŽ¨è

> åœ¨ C++ ä¸­æ›´æŽ¨èç”¨**åŒ¿åå‘½åç©ºé—´**æ›¿ä»£æ–‡ä»¶çº§Â `static`ï¼š
> è¿™èƒ½æ›´æ¸…æ™°åœ°è¡¨è¾¾ã€Œä»…é™æœ¬æ–‡ä»¶ä½¿ç”¨ã€çš„è¯­ä¹‰

```c++
// A.cpp
namespace 
{ // åŒ¿åå‘½åç©ºé—´
    int secret = 100; // æ•ˆæžœç­‰åŒäºŽ static
}
```

---

# ç±»çš„staticæˆå‘˜

> ç±»çš„Â `static`Â æˆå‘˜å…·æœ‰ç‰¹æ®Šçš„å±žæ€§å’Œç”¨æ³•

### é™æ€æˆå‘˜å˜é‡

- **ç±»çº§åˆ«å…±äº«**ï¼šæ‰€æœ‰ç±»å®žä¾‹å…±äº«åŒä¸€ä»½æ•°æ®
- **å£°æ˜Žæ–¹å¼**ï¼šç±»å†…ç”¨Â `static`Â å£°æ˜Žï¼Œç±»å¤–éœ€è¦å•ç‹¬å®šä¹‰ï¼Œä¸”å¿…é¡»åˆå§‹åŒ–


```c++
class Student {
public:
    static int chalkCount; // é™æ€æˆå‘˜å˜é‡ï¼Œå…¬å…±ç²‰ç¬”ç›’ï¼ˆæ‰€æœ‰å­¦ç”Ÿå…±äº«ï¼‰
    
    void takeChalk()
    {
        if(chalkCount > 0) 
        {
            chalkCount--;
            cout << "æ‹¿èµ°ä¸€æ”¯ç²‰ç¬”ï¼Œè¿˜å‰©" << chalkCount << "æ”¯\n";
        }
    }
};

int Student::chalkCount = 10; // åˆå§‹æœ‰10æ”¯ç²‰ç¬”

int main() 
{
    Student xiaoming;
    Student xiaohong;
    
    xiaoming.takeChalk(); // è¿˜å‰©9æ”¯ï¼ˆå°æ˜Žæ‹¿ï¼‰
    xiaohong.takeChalk(); // è¿˜å‰©8æ”¯ï¼ˆå°çº¢æ‹¿ï¼‰
}
```



---


### é™æ€æˆå‘˜å‡½æ•°

- **æ—  this æŒ‡é’ˆ**ï¼šåªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼Œä¸èƒ½è®¿é—®æ™®é€šæˆå‘˜
- **è°ƒç”¨æ–¹å¼**ï¼šå¯é€šè¿‡ç±»åç›´æŽ¥è°ƒç”¨

```c++

class School {
public:
    static void postNotice(string msg) { // é™æ€æˆå‘˜å‡½æ•°ï¼Œå…¬å…±å…¬å‘Šæ 
        cout << "ðŸ“¢ æœ€æ–°å…¬å‘Šï¼š" << msg << endl;
    }
};

// ä¸éœ€è¦åˆ›å»ºå­¦æ ¡å¯¹è±¡ï¼Œç›´æŽ¥å‘å…¬å‘Š
School::postNotice("æ˜Žå¤©åœè¯¾ä¸€å¤©"); //ç±»åç›´æŽ¥è°ƒç”¨
```


#### æˆå‘˜å‡½æ•°å¯¹å˜é‡çš„è®¿é—®æƒé™
| å‡½æ•°ç±»åž‹      | è®¿é—®é™æ€å˜é‡ | è®¿é—®éžé™æ€å˜é‡ | è°ƒç”¨æ–¹å¼     |
| --------- | ------ | ------- | -------- |
| **éžé™æ€å‡½æ•°** | âœ…      | âœ…       | éœ€è¦å¯¹è±¡å®žä¾‹è°ƒç”¨ |
| **é™æ€å‡½æ•°**  | âœ…      | âŒ       | ç±»åç›´æŽ¥è°ƒç”¨   |
- éžé™æ€å‡½æ•°éšè—äº†Â `this`Â æŒ‡é’ˆï¼ˆå¦‚Â `void func(Student* this)`ï¼‰
- é™æ€å‡½æ•°æ²¡æœ‰Â `this`Â æŒ‡é’ˆï¼Œå¦‚åŒæ™®é€šå…¨å±€å‡½æ•°ï¼ˆåªæ˜¯ä½œç”¨åŸŸåœ¨ç±»å†…ï¼‰


# å±€éƒ¨ä½œç”¨é—´çš„static

### çŽ°å®žåœºæ™¯ç±»æ¯”

```c++
void å”®è´§æœº() 
{
    static int åº“å­˜ = 10;  // é™æ€åº“å­˜ï¼ˆé•¿æœŸå­˜åœ¨ï¼‰
    int ä¸´æ—¶è´§æž¶ = 5;       // æ™®é€šå˜é‡ï¼ˆæ¯æ¬¡è°ƒç”¨æ–°å»ºï¼‰
    
    åº“å­˜--;
    ä¸´æ—¶è´§æž¶--;
    cout << "åº“å­˜ï¼š" << åº“å­˜ << " ä¸´æ—¶è´§æž¶ï¼š" << ä¸´æ—¶è´§æž¶;
}

// ç¬¬ä¸€æ¬¡è°ƒç”¨
å”®è´§æœº();  // è¾“å‡ºï¼šåº“å­˜ï¼š9 ä¸´æ—¶è´§æž¶ï¼š4
// ç¬¬äºŒæ¬¡è°ƒç”¨
å”®è´§æœº();  // è¾“å‡ºï¼šåº“å­˜ï¼š8 ä¸´æ—¶è´§æž¶ï¼š4ï¼ˆä¸´æ—¶è´§æž¶æ¯æ¬¡éƒ½é‡ç½®ï¼‰
```

```c++
//å•ä¾‹ç±»ï¼Œåªå­˜åœ¨ä¸€ä¸ªå®žçš„ç±»
class Singleton
{

private:
	static Singleton* s_Instance;
public:
	static Singleton& Get() { return *s_Instance;}
	void Hello() {}
};

Singleton* Singleton::s_Instance = nullptr;



int main()
{
	Singleton::Get().Hello();
	std::cin.get();
}

```


```c++
class Singleton
{
public:
	static Singleton& Get() 
	
	{
		static Singleton instance;
		return instance;
	}
	
	void Hello() {}
};


int main()
{
	Singleton::Get().Hello();
	std::cin.get();
}


```
---



### æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§        | é™æ€å±€éƒ¨å˜é‡     | æ™®é€šå±€éƒ¨å˜é‡      |
| --------- | ---------- | ----------- |
| **åˆå§‹åŒ–æ—¶æœº** | é¦–æ¬¡æ‰§è¡Œæ—¶åˆå§‹åŒ–ä¸€æ¬¡ | æ¯æ¬¡è¿›å…¥ä½œç”¨åŸŸéƒ½åˆå§‹åŒ– |
| **ç”Ÿå‘½å‘¨æœŸ**  | ç¨‹åºè¿è¡ŒæœŸé—´æŒç»­å­˜åœ¨ | ä½œç”¨åŸŸç»“æŸå³é”€æ¯    |
| **å†…å­˜ä½ç½®**  | æ•°æ®æ®µï¼ˆå…¨å±€åŒºï¼‰   | æ ˆå†…å­˜         |
|           |            |             |

